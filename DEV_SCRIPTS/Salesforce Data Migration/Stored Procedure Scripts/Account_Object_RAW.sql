CREATE OR REPLACE PROCEDURE RAW_DEV.DEV_RAW_SALESFORCE.ACCOUNT_LOAD()
RETURNS VARCHAR(500)
LANGUAGE SQL
EXECUTE AS OWNER
AS
$$

DECLARE email_list STRING;
	email_count NUMBER;

    
BEGIN
    -- Author:	Bharath
	-- Created: 03/17/2025
	-- Description: Loads data into ACCOUNT RAW table
	-- Modifications:03/17/2025 - Created the Procedure




INSERT INTO RAW_DEV.DEV_RAW_SALESFORCE.ACCOUNT(
AccountNumber__c,
AccountSource__c,
Additional_Color_c__c,
Advisor_c__c,
Allocation_To_Alternative_Investments_Pe__c,
AnnualRevenue__c,
Asset_Class_Search_c__c,
AUM_c__c,
AUM_Illiquid_c__c,
AUM_Liquid_c__c,
AUM_Total_c__c,
Average_Preqin_HF_Typical_Investment_c__c,
Average_Preqin_PE_Typical_Investment_c__c,
BillingCity__c,
BillingCountry__c,
BillingGeocodeAccuracy__c,
BillingLatitude__c,
BillingLongitude__c,
BillingPostalCode__c,
BillingState__c,
BillingStreet__c,
Bitcoin_Fund_AUM_c__c,
Blockchain_Fund_Class_c__c,
Blockchain_Fund_I_AUM_c__c,
Blockchain_Fund_Lead_Owner_c__c,
Blockchain_Fund_Status_c__c,
Blockchain_Investors_c__c,
Brodsky_Focus_List_c__c,
Case_Sensitive_ID_c__c,
cdp_sys_SourceVersion__c,
CIO_c__c,
Co_Investment_Estimated_Ticket_c__c,
Co_Investment_Opportunities_c__c,
Co_Investment_Program_c__c,
Comments_c__c,
Company_CRD_ID_c__c,
Company_Description_c__c,
Company_Engagement_Status_c__c,
Company_Investor_Type_c__c,
Company_Letter_Delivered_c__c,
Company_Letter_Opens_c__c,
Company_Max_Lead_Score_c__c,
Company_Met_With_c__c,
Company_Noteworthy_Details_c__c,
Company_Owner_c__c,
Company_Recent_Letter_Opens_c__c,
Company_Tags_c__c,
Company_Type_c__c,
Company_Weighted_Amount_max_c__c,
Consultant_Advisor_c__c,
CreatedById__c,
CreatedDate__c,
Dakota_Account_Available_to_Sync__c,
Dakota_Account_Last_Sync_Date_Time__c,
Dakota_Alternative_Platform_Description__c,
Dakota_Dont_Notify_Record_Creation__c,
Dakota_Emerging_Manager_Program__c,
Dakota_Emerging_Market_Equities__c,
Dakota_Form_ADV_Part_2A_Brochure__c,
Dakota_International_Equities__c,
Dakota_Investment_Policy_Statement__c,
Dakota_Invests_in_Impact_SRI_or_ESG__c,
Dakota_Is_Created_for_Record_Form__c,
Dakota_Last_Modified_Date_Time__c,
Dakota_Non_Discretionary_Assets__c,
Dakota_Opportunity_Description__c,
Dakota_Preferred_Investment_Vehicle__c,
Dakota_Private_Credit_Consultant__c,
Dakota_Private_Equity_Consultant__c,
Dakota_Quarterly_Annual_Report__c,
Dakota_Real_Estate_Consultant__c,
Dakota_Research_Team_Overview__c,
Dakota_Separate_Account_Usage__c,
Dan_Has_Met_c__c,
Data_Room_Visits_c__c,
DataSource__c,
DataSourceObject__c,
Days_Since_Last_Activity_c__c,
Description__c,
Do_Not_Invest_In_c__c,
Dynamo_c__c,
Early_Stage_Token_Fund_c__c,
Endowment_Rank_c__c,
Enterprise_Value_c__c,
Estimated_Amount_c__c,
Estimated_Investment_Size_c__c,
Estimated_Size_Logic_c__c,
Estimated_Ticket_Size_c__c,
Excel_ID_c__c,
Fax__c,
Fintrx_Classification_c__c,
Fintrx_Dataset_c__c,
Fintrx_Firm_CRD_ID_c__c,
Fintrx_Url_c__c,
Fintrxt_Total_AUM_c__c,
Firm_Marketing_Level_c__c,
Firm_Phone_Number_c__c,
Fund_V_AUM_c__c,
Funding_c__c,
Funds_c__c,
Funds_Invested_c__c,
Funds_Not_Interested_Can_t_Invest_c__c,
Funds_of_Interest_c__c,
Geographic_Preference_Search_c__c,
Have_Allocated_to_Blockchain_Strategy_c__c,
Hedge_Funds_Percent_c__c,
HF_Consultant_c__c,
High_Priority_c__c,
Highest_Historical_Marketing_Stage_c__c,
HQ_Address_c__c,
HQ_City_c__c,
HQ_Country_c__c,
HQ_Email_c__c,
HQ_Metro_Area_c__c,
HQ_Region_c__c,
HQ_State_c__c,
Id__c,
ID_c__c,
If_Close_Lost_why_c__c,
If_Family_Office_c__c,
Industry__c,
Institutional_Segmentation_c__c,
Intern_Account_ID_c__c,
Investing_on_behalf_of_c__c,
Investment_Restrictions_c__c,
Investor_Category_c__c,
Investor_Status_c__c,
Investor_Type_Search_c__c,
IsDeleted__c,
IsPriorityRecord__c,
Jigsaw__c,
JigsawCompanyId__c,
Key_Decision_Maker_s_c__c,
KQ_Id__c,
KQ_ParentId__c,
Last_Activity_By_c__c,
Last_Activity_Subject_c__c,
Last_Data_Room_Visit_c__c,
Last_Engagement_Date_c__c,
Last_Engagement_Type_c__c,
Last_Meeting_Date_c__c,
Last_Meeting_Stage_c__c,
LastActivityDate__c,
LastModifiedById__c,
LastModifiedDate__c,
LastReferencedDate__c,
LastViewedDate__c,
Legal_Structure_c__c,
Liquid_Token_Fund_AUM_c__c,
Location_Search_c__c,
LP_Since_c__c,
LTM_Annual_Revenue_c__c,
LTM_EBITDA_c__c,
LTM_Net_Income_c__c,
Manual_Estimated_Investment_Size_c__c,
Marketing_Stage_c__c,
Marketplace_Dakota_1031_Exchange_c__c,
Marketplace_Dakota_Account_Linked_c__c,
Marketplace_Dakota_Account_Name_c__c,
Marketplace_Dakota_Address_c__c,
Marketplace_Dakota_AUM_c__c,
Marketplace_Dakota_Average_Ticket_Size_c__c,
Marketplace_Dakota_Bank_Loans_c__c,
Marketplace_Dakota_Board_Meeting_Notes_c__c,
Marketplace_Dakota_CIT_Usage_c__c,
Marketplace_Dakota_City_c__c,
Marketplace_Dakota_Client_Base_c__c,
Marketplace_Dakota_CMBS_c__c,
Marketplace_Dakota_Co_Investments_c__c,
Marketplace_Dakota_Convertibles_c__c,
Marketplace_Dakota_Core_Bonds_c__c,
Marketplace_Dakota_Country_c__c,
Marketplace_Dakota_CRD_Number_c__c,
Marketplace_Dakota_Created_Date_Time_c__c,
Marketplace_Dakota_Cryptocurrency_c__c,
Marketplace_Dakota_Current_Searches_c__c,
Marketplace_Dakota_Custodian_s_c__c,
Marketplace_Dakota_DC_Consultant_c__c,
Marketplace_Dakota_Description_c__c,
Marketplace_Dakota_Discretionary_Assets__c,
Marketplace_Dakota_Emerging_Market_Bonds__c,
Marketplace_Dakota_ETF_Usage_c__c,
Marketplace_Dakota_External_Manager_Link__c,
Marketplace_Dakota_Firm_Commentary_c__c,
Marketplace_Dakota_General_Consultant_1__c,
Marketplace_Dakota_General_Consultant_2__c,
Marketplace_Dakota_Global_Equities_c__c,
Marketplace_Dakota_Government_Bonds_c__c,
Marketplace_Dakota_Hedge_FOF_c__c,
Marketplace_Dakota_Hedge_Fund_Consultant__c,
Marketplace_Dakota_Hedge_Funds_c__c,
Marketplace_Dakota_High_Yield_Bonds_c__c,
Marketplace_Dakota_Investments_Page_c__c,
Marketplace_Dakota_Investments_Team_Page__c,
Marketplace_Dakota_Is_from_Marketplace_c__c,
Marketplace_Dakota_Large_Cap_US_Equities__c,
Marketplace_Dakota_Liquid_Alternatives_c__c,
Marketplace_Dakota_LP_Power_User_c__c,
Marketplace_Dakota_LP_Usage_c__c,
Marketplace_Dakota_Main_Page_c__c,
Marketplace_Dakota_MBS_c__c,
Marketplace_Dakota_Metro_Area_Name_c__c,
Marketplace_Dakota_Micro_Cap_US_Equities__c,
Marketplace_Dakota_Mid_Cap_US_Equities_c__c,
Marketplace_Dakota_Models_c__c,
Marketplace_Dakota_Municipal_Bonds_c__c,
Marketplace_Dakota_Mutual_Fund_Usage_c__c,
Marketplace_Dakota_News_Page_c__c,
Marketplace_Dakota_Number_of_QPs_c__c,
Marketplace_Dakota_OCIO_Business_c__c,
Marketplace_Dakota_Parent_Account_c__c,
Marketplace_Dakota_Phone_c__c,
Marketplace_Dakota_Platform_Description__c,
Marketplace_Dakota_Private_Credit_c__c,
Marketplace_Dakota_Private_Equity_c__c,
Marketplace_Dakota_Private_Equity_FOF_c__c,
Marketplace_Dakota_Private_Real_Estate_c__c,
Marketplace_Dakota_Real_Assets_c__c,
Marketplace_Dakota_Real_Estate_FOF_c__c,
Marketplace_Dakota_Reference_Id_c__c,
Marketplace_Dakota_RIC_Usage_c__c,
Marketplace_Dakota_Select_Lists_c__c,
Marketplace_Dakota_Small_Cap_US_Equities__c,
Marketplace_Dakota_State_c__c,
Marketplace_Dakota_Status_c__c,
Marketplace_Dakota_Street_c__c,
Marketplace_Dakota_Sub_Advised_MF_Family__c,
Marketplace_Dakota_TAMP_c__c,
Marketplace_Dakota_Type_c__c,
Marketplace_Dakota_UCITS_Usage_c__c,
Marketplace_Dakota_UHNW_Division_c__c,
Marketplace_Dakota_UMA_Usage_c__c,
Marketplace_Dakota_Unconstrained_c__c,
Marketplace_Dakota_Venture_Capital_c__c,
Marketplace_Dakota_Website_c__c,
Marketplace_Dakota_Zip_Postal_Code_c__c,
Marketplace_is_from_auto_link_scheduler__c,
MasterRecordId__c,
Metro_Area_c__c,
Name__c,
Next_Follow_Up_Date_c__c,
No_Interest_Can_t_Invest_c__c,
Number_of_Employees_c__c,
NumberOfEmployees__c,
OperatingHoursId__c,
Other_offices_c__c,
OwnerId__c,
Ownership__c,
ParentId__c,
Park_Hill_Interest_Level_c__c,
Park_Hill_Segmentation_c__c,
PE_Consultant_c__c,
Phone__c,
PhotoUrl__c,
Pipeline_Stage_c__c,
Preferred_Fund_Type_c__c,
Preqin_AUM_Field_c__c,
Preqin_HF_Typical_Investment_Max_c__c,
Preqin_HF_Typical_Investment_Min_c__c,
Preqin_ID_c__c,
Preqin_Investor_Type_c__c,
Preqin_PE_Typical_Investment_Max_c__c,
Preqin_PE_Typical_Investment_Min_c__c,
Primary_Contact_1_c__c,
Primary_Contact_2_c__c,
Primary_Contact_3_c__c,
Primary_Contact_c__c,
Primary_Contact_Email_c__c,
Private_Equity_Percent_c__c,
Random_ID_c__c,
Rating__c,
Reason_for_Last_Meeting_c__c,
RecordTypeId__c,
Reference_Source_c__c,
Referrer_c__c,
SfdcOrganizationId__c,
ShippingCity__c,
ShippingCountry__c,
ShippingGeocodeAccuracy__c,
ShippingLatitude__c,
ShippingLongitude__c,
ShippingPostalCode__c,
ShippingState__c,
ShippingStreet__c,
Sic__c,
SicDesc__c,
Site__c,
Source_of_Ticket_c__c,
SourceSystemIdentifier__c,
Special_Opportunities_Percent_c__c,
Stage_c__c,
Strategy_Search_c__c,
SystemModstamp__c,
Target_c__c,
Themes_of_Interest_c__c,
TickerSymbol__c,
Total_AUM_c__c,
Total_Commitments_In_PE_Funds_c__c,
Total_Commitments_in_VC_Funds_c__c,
Total_Company_Meetings_Calls_c__c,
Total_Meetings_c__c,
Total_Paid_in_Capital_c__c,
Touchstone_Appendices_c__c,
Type__c,
UploadJul2014_c__c,
Venture_Fund_I_AUM_c__c,
Venture_Fund_II_AUM_c__c,
Venture_Fund_III_AUM_c__c,
Verbal_Commitment_c__c,
Website__c,
Year_Founded_c__c
)
SELECT
source."AccountNumber__c",
source."AccountSource__c",
source."Additional_Color_c__c",
source."Advisor_c__c",
source."Allocation_To_Alternative_Investments_Pe__c",
source."AnnualRevenue__c",
source."Asset_Class_Search_c__c",
source."AUM_c__c",
source."AUM_Illiquid_c__c",
source."AUM_Liquid_c__c",
source."AUM_Total_c__c",
source."Average_Preqin_HF_Typical_Investment_c__c",
source."Average_Preqin_PE_Typical_Investment_c__c",
source."BillingCity__c",
source."BillingCountry__c",
source."BillingGeocodeAccuracy__c",
source."BillingLatitude__c",
source."BillingLongitude__c",
source."BillingPostalCode__c",
source."BillingState__c",
source."BillingStreet__c",
source."Bitcoin_Fund_AUM_c__c",
source."Blockchain_Fund_Class_c__c",
source."Blockchain_Fund_I_AUM_c__c",
source."Blockchain_Fund_Lead_Owner_c__c",
source."Blockchain_Fund_Status_c__c",
source."Blockchain_Investors_c__c",
source."Brodsky_Focus_List_c__c",
source."Case_Sensitive_ID_c__c",
source."cdp_sys_SourceVersion__c",
source."CIO_c__c",
source."Co_Investment_Estimated_Ticket_c__c",
source."Co_Investment_Opportunities_c__c",
source."Co_Investment_Program_c__c",
source."Comments_c__c",
source."Company_CRD_ID_c__c",
source."Company_Description_c__c",
source."Company_Engagement_Status_c__c",
source."Company_Investor_Type_c__c",
source."Company_Letter_Delivered_c__c",
source."Company_Letter_Opens_c__c",
source."Company_Max_Lead_Score_c__c",
source."Company_Met_With_c__c",
source."Company_Noteworthy_Details_c__c",
source."Company_Owner_c__c",
source."Company_Recent_Letter_Opens_c__c",
source."Company_Tags_c__c",
source."Company_Type_c__c",
source."Company_Weighted_Amount_max_c__c",
source."Consultant_Advisor_c__c",
source."CreatedById__c",
source."CreatedDate__c",
source."Dakota_Account_Available_to_Sync__c",
source."Dakota_Account_Last_Sync_Date_Time__c",
source."Dakota_Alternative_Platform_Description__c",
source."Dakota_Dont_Notify_Record_Creation__c",
source."Dakota_Emerging_Manager_Program__c",
source."Dakota_Emerging_Market_Equities__c",
source."Dakota_Form_ADV_Part_2A_Brochure__c",
source."Dakota_International_Equities__c",
source."Dakota_Investment_Policy_Statement__c",
source."Dakota_Invests_in_Impact_SRI_or_ESG__c",
source."Dakota_Is_Created_for_Record_Form__c",
source."Dakota_Last_Modified_Date_Time__c",
source."Dakota_Non_Discretionary_Assets__c",
source."Dakota_Opportunity_Description__c",
source."Dakota_Preferred_Investment_Vehicle__c",
source."Dakota_Private_Credit_Consultant__c",
source."Dakota_Private_Equity_Consultant__c",
source."Dakota_Quarterly_Annual_Report__c",
source."Dakota_Real_Estate_Consultant__c",
source."Dakota_Research_Team_Overview__c",
source."Dakota_Separate_Account_Usage__c",
source."Dan_Has_Met_c__c",
source."Data_Room_Visits_c__c",
source."DataSource__c",
source."DataSourceObject__c",
source."Days_Since_Last_Activity_c__c",
source."Description__c",
source."Do_Not_Invest_In_c__c",
source."Dynamo_c__c",
source."Early_Stage_Token_Fund_c__c",
source."Endowment_Rank_c__c",
source."Enterprise_Value_c__c",
source."Estimated_Amount_c__c",
source."Estimated_Investment_Size_c__c",
source."Estimated_Size_Logic_c__c",
source."Estimated_Ticket_Size_c__c",
source."Excel_ID_c__c",
source."Fax__c",
source."Fintrx_Classification_c__c",
source."Fintrx_Dataset_c__c",
source."Fintrx_Firm_CRD_ID_c__c",
source."Fintrx_Url_c__c",
source."Fintrxt_Total_AUM_c__c",
source."Firm_Marketing_Level_c__c",
source."Firm_Phone_Number_c__c",
source."Fund_V_AUM_c__c",
source."Funding_c__c",
source."Funds_c__c",
source."Funds_Invested_c__c",
source."Funds_Not_Interested_Can_t_Invest_c__c",
source."Funds_of_Interest_c__c",
source."Geographic_Preference_Search_c__c",
source."Have_Allocated_to_Blockchain_Strategy_c__c",
source."Hedge_Funds_Percent_c__c",
source."HF_Consultant_c__c",
source."High_Priority_c__c",
source."Highest_Historical_Marketing_Stage_c__c",
source."HQ_Address_c__c",
source."HQ_City_c__c",
source."HQ_Country_c__c",
source."HQ_Email_c__c",
source."HQ_Metro_Area_c__c",
source."HQ_Region_c__c",
source."HQ_State_c__c",
source."Id__c",
source."ID_c__c",
source."If_Close_Lost_why_c__c",
source."If_Family_Office_c__c",
source."Industry__c",
source."Institutional_Segmentation_c__c",
source."Intern_Account_ID_c__c",
source."Investing_on_behalf_of_c__c",
source."Investment_Restrictions_c__c",
source."Investor_Category_c__c",
source."Investor_Status_c__c",
source."Investor_Type_Search_c__c",
source."IsDeleted__c",
source."IsPriorityRecord__c",
source."Jigsaw__c",
source."JigsawCompanyId__c",
source."Key_Decision_Maker_s_c__c",
source."KQ_Id__c",
source."KQ_ParentId__c",
source."Last_Activity_By_c__c",
source."Last_Activity_Subject_c__c",
source."Last_Data_Room_Visit_c__c",
source."Last_Engagement_Date_c__c",
source."Last_Engagement_Type_c__c",
source."Last_Meeting_Date_c__c",
source."Last_Meeting_Stage_c__c",
source."LastActivityDate__c",
source."LastModifiedById__c",
source."LastModifiedDate__c",
source."LastReferencedDate__c",
source."LastViewedDate__c",
source."Legal_Structure_c__c",
source."Liquid_Token_Fund_AUM_c__c",
source."Location_Search_c__c",
source."LP_Since_c__c",
source."LTM_Annual_Revenue_c__c",
source."LTM_EBITDA_c__c",
source."LTM_Net_Income_c__c",
source."Manual_Estimated_Investment_Size_c__c",
source."Marketing_Stage_c__c",
source."Marketplace_Dakota_1031_Exchange_c__c",
source."Marketplace_Dakota_Account_Linked_c__c",
source."Marketplace_Dakota_Account_Name_c__c",
source."Marketplace_Dakota_Address_c__c",
source."Marketplace_Dakota_AUM_c__c",
source."Marketplace_Dakota_Average_Ticket_Size_c__c",
source."Marketplace_Dakota_Bank_Loans_c__c",
source."Marketplace_Dakota_Board_Meeting_Notes_c__c",
source."Marketplace_Dakota_CIT_Usage_c__c",
source."Marketplace_Dakota_City_c__c",
source."Marketplace_Dakota_Client_Base_c__c",
source."Marketplace_Dakota_CMBS_c__c",
source."Marketplace_Dakota_Co_Investments_c__c",
source."Marketplace_Dakota_Convertibles_c__c",
source."Marketplace_Dakota_Core_Bonds_c__c",
source."Marketplace_Dakota_Country_c__c",
source."Marketplace_Dakota_CRD_Number_c__c",
source."Marketplace_Dakota_Created_Date_Time_c__c",
source."Marketplace_Dakota_Cryptocurrency_c__c",
source."Marketplace_Dakota_Current_Searches_c__c",
source."Marketplace_Dakota_Custodian_s_c__c",
source."Marketplace_Dakota_DC_Consultant_c__c",
source."Marketplace_Dakota_Description_c__c",
source."Marketplace_Dakota_Discretionary_Assets__c",
source."Marketplace_Dakota_Emerging_Market_Bonds__c",
source."Marketplace_Dakota_ETF_Usage_c__c",
source."Marketplace_Dakota_External_Manager_Link__c",
source."Marketplace_Dakota_Firm_Commentary_c__c",
source."Marketplace_Dakota_General_Consultant_1__c",
source."Marketplace_Dakota_General_Consultant_2__c",
source."Marketplace_Dakota_Global_Equities_c__c",
source."Marketplace_Dakota_Government_Bonds_c__c",
source."Marketplace_Dakota_Hedge_FOF_c__c",
source."Marketplace_Dakota_Hedge_Fund_Consultant__c",
source."Marketplace_Dakota_Hedge_Funds_c__c",
source."Marketplace_Dakota_High_Yield_Bonds_c__c",
source."Marketplace_Dakota_Investments_Page_c__c",
source."Marketplace_Dakota_Investments_Team_Page__c",
source."Marketplace_Dakota_Is_from_Marketplace_c__c",
source."Marketplace_Dakota_Large_Cap_US_Equities__c",
source."Marketplace_Dakota_Liquid_Alternatives_c__c",
source."Marketplace_Dakota_LP_Power_User_c__c",
source."Marketplace_Dakota_LP_Usage_c__c",
source."Marketplace_Dakota_Main_Page_c__c",
source."Marketplace_Dakota_MBS_c__c",
source."Marketplace_Dakota_Metro_Area_Name_c__c",
source."Marketplace_Dakota_Micro_Cap_US_Equities__c",
source."Marketplace_Dakota_Mid_Cap_US_Equities_c__c",
source."Marketplace_Dakota_Models_c__c",
source."Marketplace_Dakota_Municipal_Bonds_c__c",
source."Marketplace_Dakota_Mutual_Fund_Usage_c__c",
source."Marketplace_Dakota_News_Page_c__c",
source."Marketplace_Dakota_Number_of_QPs_c__c",
source."Marketplace_Dakota_OCIO_Business_c__c",
source."Marketplace_Dakota_Parent_Account_c__c",
source."Marketplace_Dakota_Phone_c__c",
source."Marketplace_Dakota_Platform_Description__c",
source."Marketplace_Dakota_Private_Credit_c__c",
source."Marketplace_Dakota_Private_Equity_c__c",
source."Marketplace_Dakota_Private_Equity_FOF_c__c",
source."Marketplace_Dakota_Private_Real_Estate_c__c",
source."Marketplace_Dakota_Real_Assets_c__c",
source."Marketplace_Dakota_Real_Estate_FOF_c__c",
source."Marketplace_Dakota_Reference_Id_c__c",
source."Marketplace_Dakota_RIC_Usage_c__c",
source."Marketplace_Dakota_Select_Lists_c__c",
source."Marketplace_Dakota_Small_Cap_US_Equities__c",
source."Marketplace_Dakota_State_c__c",
source."Marketplace_Dakota_Status_c__c",
source."Marketplace_Dakota_Street_c__c",
source."Marketplace_Dakota_Sub_Advised_MF_Family__c",
source."Marketplace_Dakota_TAMP_c__c",
source."Marketplace_Dakota_Type_c__c",
source."Marketplace_Dakota_UCITS_Usage_c__c",
source."Marketplace_Dakota_UHNW_Division_c__c",
source."Marketplace_Dakota_UMA_Usage_c__c",
source."Marketplace_Dakota_Unconstrained_c__c",
source."Marketplace_Dakota_Venture_Capital_c__c",
source."Marketplace_Dakota_Website_c__c",
source."Marketplace_Dakota_Zip_Postal_Code_c__c",
source."Marketplace_is_from_auto_link_scheduler__c",
source."MasterRecordId__c",
source."Metro_Area_c__c",
source."Name__c",
source."Next_Follow_Up_Date_c__c",
source."No_Interest_Can_t_Invest_c__c",
source."Number_of_Employees_c__c",
source."NumberOfEmployees__c",
source."OperatingHoursId__c",
source."Other_offices_c__c",
source."OwnerId__c",
source."Ownership__c",
source."ParentId__c",
source."Park_Hill_Interest_Level_c__c",
source."Park_Hill_Segmentation_c__c",
source."PE_Consultant_c__c",
source."Phone__c",
source."PhotoUrl__c",
source."Pipeline_Stage_c__c",
source."Preferred_Fund_Type_c__c",
source."Preqin_AUM_Field_c__c",
source."Preqin_HF_Typical_Investment_Max_c__c",
source."Preqin_HF_Typical_Investment_Min_c__c",
source."Preqin_ID_c__c",
source."Preqin_Investor_Type_c__c",
source."Preqin_PE_Typical_Investment_Max_c__c",
source."Preqin_PE_Typical_Investment_Min_c__c",
source."Primary_Contact_1_c__c",
source."Primary_Contact_2_c__c",
source."Primary_Contact_3_c__c",
source."Primary_Contact_c__c",
source."Primary_Contact_Email_c__c",
source."Private_Equity_Percent_c__c",
source."Random_ID_c__c",
source."Rating__c",
source."Reason_for_Last_Meeting_c__c",
source."RecordTypeId__c",
source."Reference_Source_c__c",
source."Referrer_c__c",
source."SfdcOrganizationId__c",
source."ShippingCity__c",
source."ShippingCountry__c",
source."ShippingGeocodeAccuracy__c",
source."ShippingLatitude__c",
source."ShippingLongitude__c",
source."ShippingPostalCode__c",
source."ShippingState__c",
source."ShippingStreet__c",
source."Sic__c",
source."SicDesc__c",
source."Site__c",
source."Source_of_Ticket_c__c",
source."SourceSystemIdentifier__c",
source."Special_Opportunities_Percent_c__c",
source."Stage_c__c",
source."Strategy_Search_c__c",
source."SystemModstamp__c",
source."Target_c__c",
source."Themes_of_Interest_c__c",
source."TickerSymbol__c",
source."Total_AUM_c__c",
source."Total_Commitments_In_PE_Funds_c__c",
source."Total_Commitments_in_VC_Funds_c__c",
source."Total_Company_Meetings_Calls_c__c",
source."Total_Meetings_c__c",
source."Total_Paid_in_Capital_c__c",
source."Touchstone_Appendices_c__c",
source."Type__c",
source."UploadJul2014_c__c",
source."Venture_Fund_I_AUM_c__c",
source."Venture_Fund_II_AUM_c__c",
source."Venture_Fund_III_AUM_c__c",
source."Verbal_Commitment_c__c",
source."Website__c",
source."Year_Founded_c__c"
FROM RBB92105_PROD5CDP1ACCOUNT01_DATATOSNOWFLAKE_00DG0000000LNIGMA2."schema_DataToSnowFlake"."Account_Home__dll" source
LEFT JOIN RAW_DEV.DEV_RAW_SALESFORCE.ACCOUNT target on source."Id__c"=target.Id__c
WHERE target.Id__c IS NULL;

INSERT INTO HARMONIZED_DEV.AUDIT_LOGS.AUDIT (
        SOURCE,
        DATABASE_NAME,
        SCHEMA_NAME,
        TABLE_NAME,
        ROW_COUNT,
        LOAD_TIMESTAMP,
        PROCEDURE_NAME,
        STATUS,
    ERROR_MESSAGE
    ) 
    VALUES(
        'SALESFORCE',
        'RAW_DEV',
        'DEV_RAW_SALESFORCE',
        'ACCOUNT',
        :SQLROWCOUNT,
        CURRENT_TIMESTAMP(),
        'ACCOUNT_LOAD',
        'INSERT SUCCESS',
        NULL
    );

UPDATE RAW_DEV.DEV_RAW_SALESFORCE.ACCOUNT target
SET
    target.AccountNumber__c=source."AccountNumber__c",
target.AccountSource__c=source."AccountSource__c",
target.Additional_Color_c__c=source."Additional_Color_c__c",
target.Advisor_c__c=source."Advisor_c__c",
target.Allocation_To_Alternative_Investments_Pe__c=source."Allocation_To_Alternative_Investments_Pe__c",
target.AnnualRevenue__c=source."AnnualRevenue__c",
target.Asset_Class_Search_c__c=source."Asset_Class_Search_c__c",
target.AUM_c__c=source."AUM_c__c",
target.AUM_Illiquid_c__c=source."AUM_Illiquid_c__c",
target.AUM_Liquid_c__c=source."AUM_Liquid_c__c",
target.AUM_Total_c__c=source."AUM_Total_c__c",
target.Average_Preqin_HF_Typical_Investment_c__c=source."Average_Preqin_HF_Typical_Investment_c__c",
target.Average_Preqin_PE_Typical_Investment_c__c=source."Average_Preqin_PE_Typical_Investment_c__c",
target.BillingCity__c=source."BillingCity__c",
target.BillingCountry__c=source."BillingCountry__c",
target.BillingGeocodeAccuracy__c=source."BillingGeocodeAccuracy__c",
target.BillingLatitude__c=source."BillingLatitude__c",
target.BillingLongitude__c=source."BillingLongitude__c",
target.BillingPostalCode__c=source."BillingPostalCode__c",
target.BillingState__c=source."BillingState__c",
target.BillingStreet__c=source."BillingStreet__c",
target.Bitcoin_Fund_AUM_c__c=source."Bitcoin_Fund_AUM_c__c",
target.Blockchain_Fund_Class_c__c=source."Blockchain_Fund_Class_c__c",
target.Blockchain_Fund_I_AUM_c__c=source."Blockchain_Fund_I_AUM_c__c",
target.Blockchain_Fund_Lead_Owner_c__c=source."Blockchain_Fund_Lead_Owner_c__c",
target.Blockchain_Fund_Status_c__c=source."Blockchain_Fund_Status_c__c",
target.Blockchain_Investors_c__c=source."Blockchain_Investors_c__c",
target.Brodsky_Focus_List_c__c=source."Brodsky_Focus_List_c__c",
target.Case_Sensitive_ID_c__c=source."Case_Sensitive_ID_c__c",
target.cdp_sys_SourceVersion__c=source."cdp_sys_SourceVersion__c",
target.CIO_c__c=source."CIO_c__c",
target.Co_Investment_Estimated_Ticket_c__c=source."Co_Investment_Estimated_Ticket_c__c",
target.Co_Investment_Opportunities_c__c=source."Co_Investment_Opportunities_c__c",
target.Co_Investment_Program_c__c=source."Co_Investment_Program_c__c",
target.Comments_c__c=source."Comments_c__c",
target.Company_CRD_ID_c__c=source."Company_CRD_ID_c__c",
target.Company_Description_c__c=source."Company_Description_c__c",
target.Company_Engagement_Status_c__c=source."Company_Engagement_Status_c__c",
target.Company_Investor_Type_c__c=source."Company_Investor_Type_c__c",
target.Company_Letter_Delivered_c__c=source."Company_Letter_Delivered_c__c",
target.Company_Letter_Opens_c__c=source."Company_Letter_Opens_c__c",
target.Company_Max_Lead_Score_c__c=source."Company_Max_Lead_Score_c__c",
target.Company_Met_With_c__c=source."Company_Met_With_c__c",
target.Company_Noteworthy_Details_c__c=source."Company_Noteworthy_Details_c__c",
target.Company_Owner_c__c=source."Company_Owner_c__c",
target.Company_Recent_Letter_Opens_c__c=source."Company_Recent_Letter_Opens_c__c",
target.Company_Tags_c__c=source."Company_Tags_c__c",
target.Company_Type_c__c=source."Company_Type_c__c",
target.Company_Weighted_Amount_max_c__c=source."Company_Weighted_Amount_max_c__c",
target.Consultant_Advisor_c__c=source."Consultant_Advisor_c__c",
target.CreatedById__c=source."CreatedById__c",
target.CreatedDate__c=source."CreatedDate__c",
target.Dakota_Account_Available_to_Sync__c=source."Dakota_Account_Available_to_Sync__c",
target.Dakota_Account_Last_Sync_Date_Time__c=source."Dakota_Account_Last_Sync_Date_Time__c",
target.Dakota_Alternative_Platform_Description__c=source."Dakota_Alternative_Platform_Description__c",
target.Dakota_Dont_Notify_Record_Creation__c=source."Dakota_Dont_Notify_Record_Creation__c",
target.Dakota_Emerging_Manager_Program__c=source."Dakota_Emerging_Manager_Program__c",
target.Dakota_Emerging_Market_Equities__c=source."Dakota_Emerging_Market_Equities__c",
target.Dakota_Form_ADV_Part_2A_Brochure__c=source."Dakota_Form_ADV_Part_2A_Brochure__c",
target.Dakota_International_Equities__c=source."Dakota_International_Equities__c",
target.Dakota_Investment_Policy_Statement__c=source."Dakota_Investment_Policy_Statement__c",
target.Dakota_Invests_in_Impact_SRI_or_ESG__c=source."Dakota_Invests_in_Impact_SRI_or_ESG__c",
target.Dakota_Is_Created_for_Record_Form__c=source."Dakota_Is_Created_for_Record_Form__c",
target.Dakota_Last_Modified_Date_Time__c=source."Dakota_Last_Modified_Date_Time__c",
target.Dakota_Non_Discretionary_Assets__c=source."Dakota_Non_Discretionary_Assets__c",
target.Dakota_Opportunity_Description__c=source."Dakota_Opportunity_Description__c",
target.Dakota_Preferred_Investment_Vehicle__c=source."Dakota_Preferred_Investment_Vehicle__c",
target.Dakota_Private_Credit_Consultant__c=source."Dakota_Private_Credit_Consultant__c",
target.Dakota_Private_Equity_Consultant__c=source."Dakota_Private_Equity_Consultant__c",
target.Dakota_Quarterly_Annual_Report__c=source."Dakota_Quarterly_Annual_Report__c",
target.Dakota_Real_Estate_Consultant__c=source."Dakota_Real_Estate_Consultant__c",
target.Dakota_Research_Team_Overview__c=source."Dakota_Research_Team_Overview__c",
target.Dakota_Separate_Account_Usage__c=source."Dakota_Separate_Account_Usage__c",
target.Dan_Has_Met_c__c=source."Dan_Has_Met_c__c",
target.Data_Room_Visits_c__c=source."Data_Room_Visits_c__c",
target.DataSource__c=source."DataSource__c",
target.DataSourceObject__c=source."DataSourceObject__c",
target.Days_Since_Last_Activity_c__c=source."Days_Since_Last_Activity_c__c",
target.Description__c=source."Description__c",
target.Do_Not_Invest_In_c__c=source."Do_Not_Invest_In_c__c",
target.Dynamo_c__c=source."Dynamo_c__c",
target.Early_Stage_Token_Fund_c__c=source."Early_Stage_Token_Fund_c__c",
target.Endowment_Rank_c__c=source."Endowment_Rank_c__c",
target.Enterprise_Value_c__c=source."Enterprise_Value_c__c",
target.Estimated_Amount_c__c=source."Estimated_Amount_c__c",
target.Estimated_Investment_Size_c__c=source."Estimated_Investment_Size_c__c",
target.Estimated_Size_Logic_c__c=source."Estimated_Size_Logic_c__c",
target.Estimated_Ticket_Size_c__c=source."Estimated_Ticket_Size_c__c",
target.Excel_ID_c__c=source."Excel_ID_c__c",
target.Fax__c=source."Fax__c",
target.Fintrx_Classification_c__c=source."Fintrx_Classification_c__c",
target.Fintrx_Dataset_c__c=source."Fintrx_Dataset_c__c",
target.Fintrx_Firm_CRD_ID_c__c=source."Fintrx_Firm_CRD_ID_c__c",
target.Fintrx_Url_c__c=source."Fintrx_Url_c__c",
target.Fintrxt_Total_AUM_c__c=source."Fintrxt_Total_AUM_c__c",
target.Firm_Marketing_Level_c__c=source."Firm_Marketing_Level_c__c",
target.Firm_Phone_Number_c__c=source."Firm_Phone_Number_c__c",
target.Fund_V_AUM_c__c=source."Fund_V_AUM_c__c",
target.Funding_c__c=source."Funding_c__c",
target.Funds_c__c=source."Funds_c__c",
target.Funds_Invested_c__c=source."Funds_Invested_c__c",
target.Funds_Not_Interested_Can_t_Invest_c__c=source."Funds_Not_Interested_Can_t_Invest_c__c",
target.Funds_of_Interest_c__c=source."Funds_of_Interest_c__c",
target.Geographic_Preference_Search_c__c=source."Geographic_Preference_Search_c__c",
target.Have_Allocated_to_Blockchain_Strategy_c__c=source."Have_Allocated_to_Blockchain_Strategy_c__c",
target.Hedge_Funds_Percent_c__c=source."Hedge_Funds_Percent_c__c",
target.HF_Consultant_c__c=source."HF_Consultant_c__c",
target.High_Priority_c__c=source."High_Priority_c__c",
target.Highest_Historical_Marketing_Stage_c__c=source."Highest_Historical_Marketing_Stage_c__c",
target.HQ_Address_c__c=source."HQ_Address_c__c",
target.HQ_City_c__c=source."HQ_City_c__c",
target.HQ_Country_c__c=source."HQ_Country_c__c",
target.HQ_Email_c__c=source."HQ_Email_c__c",
target.HQ_Metro_Area_c__c=source."HQ_Metro_Area_c__c",
target.HQ_Region_c__c=source."HQ_Region_c__c",
target.HQ_State_c__c=source."HQ_State_c__c",
target.Id__c=source."Id__c",
target.ID_c__c=source."ID_c__c",
target.If_Close_Lost_why_c__c=source."If_Close_Lost_why_c__c",
target.If_Family_Office_c__c=source."If_Family_Office_c__c",
target.Industry__c=source."Industry__c",
target.Institutional_Segmentation_c__c=source."Institutional_Segmentation_c__c",
target.Intern_Account_ID_c__c=source."Intern_Account_ID_c__c",
target.Investing_on_behalf_of_c__c=source."Investing_on_behalf_of_c__c",
target.Investment_Restrictions_c__c=source."Investment_Restrictions_c__c",
target.Investor_Category_c__c=source."Investor_Category_c__c",
target.Investor_Status_c__c=source."Investor_Status_c__c",
target.Investor_Type_Search_c__c=source."Investor_Type_Search_c__c",
target.IsDeleted__c=source."IsDeleted__c",
target.IsPriorityRecord__c=source."IsPriorityRecord__c",
target.Jigsaw__c=source."Jigsaw__c",
target.JigsawCompanyId__c=source."JigsawCompanyId__c",
target.Key_Decision_Maker_s_c__c=source."Key_Decision_Maker_s_c__c",
target.KQ_Id__c=source."KQ_Id__c",
target.KQ_ParentId__c=source."KQ_ParentId__c",
target.Last_Activity_By_c__c=source."Last_Activity_By_c__c",
target.Last_Activity_Subject_c__c=source."Last_Activity_Subject_c__c",
target.Last_Data_Room_Visit_c__c=source."Last_Data_Room_Visit_c__c",
target.Last_Engagement_Date_c__c=source."Last_Engagement_Date_c__c",
target.Last_Engagement_Type_c__c=source."Last_Engagement_Type_c__c",
target.Last_Meeting_Date_c__c=source."Last_Meeting_Date_c__c",
target.Last_Meeting_Stage_c__c=source."Last_Meeting_Stage_c__c",
target.LastActivityDate__c=source."LastActivityDate__c",
target.LastModifiedById__c=source."LastModifiedById__c",
target.LastModifiedDate__c=source."LastModifiedDate__c",
target.LastReferencedDate__c=source."LastReferencedDate__c",
target.LastViewedDate__c=source."LastViewedDate__c",
target.Legal_Structure_c__c=source."Legal_Structure_c__c",
target.Liquid_Token_Fund_AUM_c__c=source."Liquid_Token_Fund_AUM_c__c",
target.Location_Search_c__c=source."Location_Search_c__c",
target.LP_Since_c__c=source."LP_Since_c__c",
target.LTM_Annual_Revenue_c__c=source."LTM_Annual_Revenue_c__c",
target.LTM_EBITDA_c__c=source."LTM_EBITDA_c__c",
target.LTM_Net_Income_c__c=source."LTM_Net_Income_c__c",
target.Manual_Estimated_Investment_Size_c__c=source."Manual_Estimated_Investment_Size_c__c",
target.Marketing_Stage_c__c=source."Marketing_Stage_c__c",
target.Marketplace_Dakota_1031_Exchange_c__c=source."Marketplace_Dakota_1031_Exchange_c__c",
target.Marketplace_Dakota_Account_Linked_c__c=source."Marketplace_Dakota_Account_Linked_c__c",
target.Marketplace_Dakota_Account_Name_c__c=source."Marketplace_Dakota_Account_Name_c__c",
target.Marketplace_Dakota_Address_c__c=source."Marketplace_Dakota_Address_c__c",
target.Marketplace_Dakota_AUM_c__c=source."Marketplace_Dakota_AUM_c__c",
target.Marketplace_Dakota_Average_Ticket_Size_c__c=source."Marketplace_Dakota_Average_Ticket_Size_c__c",
target.Marketplace_Dakota_Bank_Loans_c__c=source."Marketplace_Dakota_Bank_Loans_c__c",
target.Marketplace_Dakota_Board_Meeting_Notes_c__c=source."Marketplace_Dakota_Board_Meeting_Notes_c__c",
target.Marketplace_Dakota_CIT_Usage_c__c=source."Marketplace_Dakota_CIT_Usage_c__c",
target.Marketplace_Dakota_City_c__c=source."Marketplace_Dakota_City_c__c",
target.Marketplace_Dakota_Client_Base_c__c=source."Marketplace_Dakota_Client_Base_c__c",
target.Marketplace_Dakota_CMBS_c__c=source."Marketplace_Dakota_CMBS_c__c",
target.Marketplace_Dakota_Co_Investments_c__c=source."Marketplace_Dakota_Co_Investments_c__c",
target.Marketplace_Dakota_Convertibles_c__c=source."Marketplace_Dakota_Convertibles_c__c",
target.Marketplace_Dakota_Core_Bonds_c__c=source."Marketplace_Dakota_Core_Bonds_c__c",
target.Marketplace_Dakota_Country_c__c=source."Marketplace_Dakota_Country_c__c",
target.Marketplace_Dakota_CRD_Number_c__c=source."Marketplace_Dakota_CRD_Number_c__c",
target.Marketplace_Dakota_Created_Date_Time_c__c=source."Marketplace_Dakota_Created_Date_Time_c__c",
target.Marketplace_Dakota_Cryptocurrency_c__c=source."Marketplace_Dakota_Cryptocurrency_c__c",
target.Marketplace_Dakota_Current_Searches_c__c=source."Marketplace_Dakota_Current_Searches_c__c",
target.Marketplace_Dakota_Custodian_s_c__c=source."Marketplace_Dakota_Custodian_s_c__c",
target.Marketplace_Dakota_DC_Consultant_c__c=source."Marketplace_Dakota_DC_Consultant_c__c",
target.Marketplace_Dakota_Description_c__c=source."Marketplace_Dakota_Description_c__c",
target.Marketplace_Dakota_Discretionary_Assets__c=source."Marketplace_Dakota_Discretionary_Assets__c",
target.Marketplace_Dakota_Emerging_Market_Bonds__c=source."Marketplace_Dakota_Emerging_Market_Bonds__c",
target.Marketplace_Dakota_ETF_Usage_c__c=source."Marketplace_Dakota_ETF_Usage_c__c",
target.Marketplace_Dakota_External_Manager_Link__c=source."Marketplace_Dakota_External_Manager_Link__c",
target.Marketplace_Dakota_Firm_Commentary_c__c=source."Marketplace_Dakota_Firm_Commentary_c__c",
target.Marketplace_Dakota_General_Consultant_1__c=source."Marketplace_Dakota_General_Consultant_1__c",
target.Marketplace_Dakota_General_Consultant_2__c=source."Marketplace_Dakota_General_Consultant_2__c",
target.Marketplace_Dakota_Global_Equities_c__c=source."Marketplace_Dakota_Global_Equities_c__c",
target.Marketplace_Dakota_Government_Bonds_c__c=source."Marketplace_Dakota_Government_Bonds_c__c",
target.Marketplace_Dakota_Hedge_FOF_c__c=source."Marketplace_Dakota_Hedge_FOF_c__c",
target.Marketplace_Dakota_Hedge_Fund_Consultant__c=source."Marketplace_Dakota_Hedge_Fund_Consultant__c",
target.Marketplace_Dakota_Hedge_Funds_c__c=source."Marketplace_Dakota_Hedge_Funds_c__c",
target.Marketplace_Dakota_High_Yield_Bonds_c__c=source."Marketplace_Dakota_High_Yield_Bonds_c__c",
target.Marketplace_Dakota_Investments_Page_c__c=source."Marketplace_Dakota_Investments_Page_c__c",
target.Marketplace_Dakota_Investments_Team_Page__c=source."Marketplace_Dakota_Investments_Team_Page__c",
target.Marketplace_Dakota_Is_from_Marketplace_c__c=source."Marketplace_Dakota_Is_from_Marketplace_c__c",
target.Marketplace_Dakota_Large_Cap_US_Equities__c=source."Marketplace_Dakota_Large_Cap_US_Equities__c",
target.Marketplace_Dakota_Liquid_Alternatives_c__c=source."Marketplace_Dakota_Liquid_Alternatives_c__c",
target.Marketplace_Dakota_LP_Power_User_c__c=source."Marketplace_Dakota_LP_Power_User_c__c",
target.Marketplace_Dakota_LP_Usage_c__c=source."Marketplace_Dakota_LP_Usage_c__c",
target.Marketplace_Dakota_Main_Page_c__c=source."Marketplace_Dakota_Main_Page_c__c",
target.Marketplace_Dakota_MBS_c__c=source."Marketplace_Dakota_MBS_c__c",
target.Marketplace_Dakota_Metro_Area_Name_c__c=source."Marketplace_Dakota_Metro_Area_Name_c__c",
target.Marketplace_Dakota_Micro_Cap_US_Equities__c=source."Marketplace_Dakota_Micro_Cap_US_Equities__c",
target.Marketplace_Dakota_Mid_Cap_US_Equities_c__c=source."Marketplace_Dakota_Mid_Cap_US_Equities_c__c",
target.Marketplace_Dakota_Models_c__c=source."Marketplace_Dakota_Models_c__c",
target.Marketplace_Dakota_Municipal_Bonds_c__c=source."Marketplace_Dakota_Municipal_Bonds_c__c",
target.Marketplace_Dakota_Mutual_Fund_Usage_c__c=source."Marketplace_Dakota_Mutual_Fund_Usage_c__c",
target.Marketplace_Dakota_News_Page_c__c=source."Marketplace_Dakota_News_Page_c__c",
target.Marketplace_Dakota_Number_of_QPs_c__c=source."Marketplace_Dakota_Number_of_QPs_c__c",
target.Marketplace_Dakota_OCIO_Business_c__c=source."Marketplace_Dakota_OCIO_Business_c__c",
target.Marketplace_Dakota_Parent_Account_c__c=source."Marketplace_Dakota_Parent_Account_c__c",
target.Marketplace_Dakota_Phone_c__c=source."Marketplace_Dakota_Phone_c__c",
target.Marketplace_Dakota_Platform_Description__c=source."Marketplace_Dakota_Platform_Description__c",
target.Marketplace_Dakota_Private_Credit_c__c=source."Marketplace_Dakota_Private_Credit_c__c",
target.Marketplace_Dakota_Private_Equity_c__c=source."Marketplace_Dakota_Private_Equity_c__c",
target.Marketplace_Dakota_Private_Equity_FOF_c__c=source."Marketplace_Dakota_Private_Equity_FOF_c__c",
target.Marketplace_Dakota_Private_Real_Estate_c__c=source."Marketplace_Dakota_Private_Real_Estate_c__c",
target.Marketplace_Dakota_Real_Assets_c__c=source."Marketplace_Dakota_Real_Assets_c__c",
target.Marketplace_Dakota_Real_Estate_FOF_c__c=source."Marketplace_Dakota_Real_Estate_FOF_c__c",
target.Marketplace_Dakota_Reference_Id_c__c=source."Marketplace_Dakota_Reference_Id_c__c",
target.Marketplace_Dakota_RIC_Usage_c__c=source."Marketplace_Dakota_RIC_Usage_c__c",
target.Marketplace_Dakota_Select_Lists_c__c=source."Marketplace_Dakota_Select_Lists_c__c",
target.Marketplace_Dakota_Small_Cap_US_Equities__c=source."Marketplace_Dakota_Small_Cap_US_Equities__c",
target.Marketplace_Dakota_State_c__c=source."Marketplace_Dakota_State_c__c",
target.Marketplace_Dakota_Status_c__c=source."Marketplace_Dakota_Status_c__c",
target.Marketplace_Dakota_Street_c__c=source."Marketplace_Dakota_Street_c__c",
target.Marketplace_Dakota_Sub_Advised_MF_Family__c=source."Marketplace_Dakota_Sub_Advised_MF_Family__c",
target.Marketplace_Dakota_TAMP_c__c=source."Marketplace_Dakota_TAMP_c__c",
target.Marketplace_Dakota_Type_c__c=source."Marketplace_Dakota_Type_c__c",
target.Marketplace_Dakota_UCITS_Usage_c__c=source."Marketplace_Dakota_UCITS_Usage_c__c",
target.Marketplace_Dakota_UHNW_Division_c__c=source."Marketplace_Dakota_UHNW_Division_c__c",
target.Marketplace_Dakota_UMA_Usage_c__c=source."Marketplace_Dakota_UMA_Usage_c__c",
target.Marketplace_Dakota_Unconstrained_c__c=source."Marketplace_Dakota_Unconstrained_c__c",
target.Marketplace_Dakota_Venture_Capital_c__c=source."Marketplace_Dakota_Venture_Capital_c__c",
target.Marketplace_Dakota_Website_c__c=source."Marketplace_Dakota_Website_c__c",
target.Marketplace_Dakota_Zip_Postal_Code_c__c=source."Marketplace_Dakota_Zip_Postal_Code_c__c",
target.Marketplace_is_from_auto_link_scheduler__c=source."Marketplace_is_from_auto_link_scheduler__c",
target.MasterRecordId__c=source."MasterRecordId__c",
target.Metro_Area_c__c=source."Metro_Area_c__c",
target.Name__c=source."Name__c",
target.Next_Follow_Up_Date_c__c=source."Next_Follow_Up_Date_c__c",
target.No_Interest_Can_t_Invest_c__c=source."No_Interest_Can_t_Invest_c__c",
target.Number_of_Employees_c__c=source."Number_of_Employees_c__c",
target.NumberOfEmployees__c=source."NumberOfEmployees__c",
target.OperatingHoursId__c=source."OperatingHoursId__c",
target.Other_offices_c__c=source."Other_offices_c__c",
target.OwnerId__c=source."OwnerId__c",
target.Ownership__c=source."Ownership__c",
target.ParentId__c=source."ParentId__c",
target.Park_Hill_Interest_Level_c__c=source."Park_Hill_Interest_Level_c__c",
target.Park_Hill_Segmentation_c__c=source."Park_Hill_Segmentation_c__c",
target.PE_Consultant_c__c=source."PE_Consultant_c__c",
target.Phone__c=source."Phone__c",
target.PhotoUrl__c=source."PhotoUrl__c",
target.Pipeline_Stage_c__c=source."Pipeline_Stage_c__c",
target.Preferred_Fund_Type_c__c=source."Preferred_Fund_Type_c__c",
target.Preqin_AUM_Field_c__c=source."Preqin_AUM_Field_c__c",
target.Preqin_HF_Typical_Investment_Max_c__c=source."Preqin_HF_Typical_Investment_Max_c__c",
target.Preqin_HF_Typical_Investment_Min_c__c=source."Preqin_HF_Typical_Investment_Min_c__c",
target.Preqin_ID_c__c=source."Preqin_ID_c__c",
target.Preqin_Investor_Type_c__c=source."Preqin_Investor_Type_c__c",
target.Preqin_PE_Typical_Investment_Max_c__c=source."Preqin_PE_Typical_Investment_Max_c__c",
target.Preqin_PE_Typical_Investment_Min_c__c=source."Preqin_PE_Typical_Investment_Min_c__c",
target.Primary_Contact_1_c__c=source."Primary_Contact_1_c__c",
target.Primary_Contact_2_c__c=source."Primary_Contact_2_c__c",
target.Primary_Contact_3_c__c=source."Primary_Contact_3_c__c",
target.Primary_Contact_c__c=source."Primary_Contact_c__c",
target.Primary_Contact_Email_c__c=source."Primary_Contact_Email_c__c",
target.Private_Equity_Percent_c__c=source."Private_Equity_Percent_c__c",
target.Random_ID_c__c=source."Random_ID_c__c",
target.Rating__c=source."Rating__c",
target.Reason_for_Last_Meeting_c__c=source."Reason_for_Last_Meeting_c__c",
target.RecordTypeId__c=source."RecordTypeId__c",
target.Reference_Source_c__c=source."Reference_Source_c__c",
target.Referrer_c__c=source."Referrer_c__c",
target.SfdcOrganizationId__c=source."SfdcOrganizationId__c",
target.ShippingCity__c=source."ShippingCity__c",
target.ShippingCountry__c=source."ShippingCountry__c",
target.ShippingGeocodeAccuracy__c=source."ShippingGeocodeAccuracy__c",
target.ShippingLatitude__c=source."ShippingLatitude__c",
target.ShippingLongitude__c=source."ShippingLongitude__c",
target.ShippingPostalCode__c=source."ShippingPostalCode__c",
target.ShippingState__c=source."ShippingState__c",
target.ShippingStreet__c=source."ShippingStreet__c",
target.Sic__c=source."Sic__c",
target.SicDesc__c=source."SicDesc__c",
target.Site__c=source."Site__c",
target.Source_of_Ticket_c__c=source."Source_of_Ticket_c__c",
target.SourceSystemIdentifier__c=source."SourceSystemIdentifier__c",
target.Special_Opportunities_Percent_c__c=source."Special_Opportunities_Percent_c__c",
target.Stage_c__c=source."Stage_c__c",
target.Strategy_Search_c__c=source."Strategy_Search_c__c",
target.SystemModstamp__c=source."SystemModstamp__c",
target.Target_c__c=source."Target_c__c",
target.Themes_of_Interest_c__c=source."Themes_of_Interest_c__c",
target.TickerSymbol__c=source."TickerSymbol__c",
target.Total_AUM_c__c=source."Total_AUM_c__c",
target.Total_Commitments_In_PE_Funds_c__c=source."Total_Commitments_In_PE_Funds_c__c",
target.Total_Commitments_in_VC_Funds_c__c=source."Total_Commitments_in_VC_Funds_c__c",
target.Total_Company_Meetings_Calls_c__c=source."Total_Company_Meetings_Calls_c__c",
target.Total_Meetings_c__c=source."Total_Meetings_c__c",
target.Total_Paid_in_Capital_c__c=source."Total_Paid_in_Capital_c__c",
target.Touchstone_Appendices_c__c=source."Touchstone_Appendices_c__c",
target.Type__c=source."Type__c",
target.UploadJul2014_c__c=source."UploadJul2014_c__c",
target.Venture_Fund_I_AUM_c__c=source."Venture_Fund_I_AUM_c__c",
target.Venture_Fund_II_AUM_c__c=source."Venture_Fund_II_AUM_c__c",
target.Venture_Fund_III_AUM_c__c=source."Venture_Fund_III_AUM_c__c",
target.Verbal_Commitment_c__c=source."Verbal_Commitment_c__c",
target.Website__c=source."Website__c",
target.Year_Founded_c__c=source."Year_Founded_c__c"
FROM RBB92105_PROD5CDP1ACCOUNT01_DATATOSNOWFLAKE_00DG0000000LNIGMA2."schema_DataToSnowFlake"."Account_Home__dll" source
WHERE source."Id__c"=target.Id__c AND source."LastModifiedDate__c" > target.LastModifiedDate__c;

INSERT INTO HARMONIZED_DEV.AUDIT_LOGS.AUDIT (
        SOURCE,
        DATABASE_NAME,
        SCHEMA_NAME,
        TABLE_NAME,
        ROW_COUNT,
        LOAD_TIMESTAMP,
        PROCEDURE_NAME,
        STATUS,
    ERROR_MESSAGE
    ) 
    VALUES(
        'SALESFORCE',
        'RAW_DEV',
        'DEV_RAW_SALESFORCE',
        'ACCOUNT',
        :SQLROWCOUNT,
        CURRENT_TIMESTAMP(),
        'ACCOUNT_LOAD',
        'UPDATE SUCCESS',
        NULL
    );

DELETE FROM RAW_DEV.DEV_RAW_SALESFORCE.ACCOUNT
WHERE ID__C IN 
(SELECT target.ID__C
FROM RAW_DEV.DEV_RAW_SALESFORCE.ACCOUNT target
LEFT JOIN RBB92105_PROD5CDP1ACCOUNT01_DATATOSNOWFLAKE_00DG0000000LNIGMA2."schema_DataToSnowFlake"."Account_Home__dll" source
ON target.ID__C = source."Id__c"
WHERE source."Id__c" IS NULL);

INSERT INTO HARMONIZED_DEV.AUDIT_LOGS.AUDIT (
        SOURCE,
        DATABASE_NAME,
        SCHEMA_NAME,
        TABLE_NAME,
        ROW_COUNT,
        LOAD_TIMESTAMP,
        PROCEDURE_NAME,
        STATUS,
    ERROR_MESSAGE
    ) 
    VALUES(
        'SALESFORCE',
        'RAW_DEV',
        'DEV_RAW_SALESFORCE',
        'ACCOUNT',
        :SQLROWCOUNT,
        CURRENT_TIMESTAMP(),
        'ACCOUNT_LOAD',
        'DELETE SUCCESS',
        NULL
    );


EXCEPTION
    WHEN OTHER THEN
        SELECT COUNT(*) INTO :email_count FROM RAW_DEV.DEV_RAW_MERAKI.EMAIL WHERE flag = TRUE;
        IF (:email_count > 0) THEN
    
             SELECT ARRAY_TO_STRING(ARRAY_AGG(email_id),',')
             into email_list
             from RAW_DEV.DEV_RAW_MERAKI.EMAIL 
             where flag =TRUE;
             call system$send_email(
                'email_integration',
                :email_list,
                 'Email Alert: Error while executing ACCOUNT_LOAD Procedure',
              :sqlerrm
             );
        END IF;
        
        INSERT INTO HARMONIZED_DEV.AUDIT_LOGS.AUDIT (
        SOURCE,
        DATABASE_NAME,
        SCHEMA_NAME,
        TABLE_NAME,
        ROW_COUNT,
        LOAD_TIMESTAMP,
        PROCEDURE_NAME,
        STATUS,
    ERROR_MESSAGE
    ) 
    VALUES(
        'SALESFORCE',
        'RAW_DEV',
        'DEV_RAW_SALESFORCE',
        'ACCOUNT',
        0,
        CURRENT_TIMESTAMP(),
        'ACCOUNT_LOAD',
        'FAILURE',
        :SQLERRM
    );


END;
$$;